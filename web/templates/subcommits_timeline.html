<div class="subcommits-container" {{if not .Subcommits}} hx-get="/subcommits-timeline?repo_id={{.RepoID}}"
    hx-trigger="every 10s" hx-swap="outerHTML" {{end}}>
    {{if .Subcommits}}
    <!-- CONTENIDO FINAL (Polling detenido) -->
    <div class="space-y-6">
        {{range .Subcommits}}
        <div class="bg-gray-50 p-6 rounded-lg shadow-md border-l-4 {{if eq .Type " feature"}}border-blue-500{{else if eq
            .Type "fix" }}border-red-500{{else if eq .Type "refactor"
            }}border-yellow-500{{else}}border-gray-300{{end}}">
            <div class="flex items-center mb-2">
                <span class="text-sm font-medium text-gray-500 mr-3">{{.CreatedAt.Format "02 Jan 2006"}}</span>
                <span
                    class="px-2 py-1 text-xs font-semibold rounded-full bg-indigo-100 text-indigo-800">{{.Type}}</span>
                {{if .Epic}}
                <span
                    class="ml-2 px-2 py-1 text-xs font-semibold rounded-full bg-purple-100 text-purple-800">{{.Epic}}</span>
                {{end}}
            </div>
            <h3 class="text-xl font-bold text-gray-900 mb-2">{{.Title}}</h3>
            <p class="text-gray-700 mb-2">{{.Idea}}</p>
            <div class="flex flex-wrap items-center text-sm text-gray-500">
                <span class="mr-4">SHA: <code class="bg-gray-200 px-1 rounded">{{.CommitSHA}}</code></span>
                {{if .Files}}
                <span class="flex items-center">Archivos:
                    {{range .Files}}
                    <span class="ml-1 px-2 py-0.5 bg-gray-200 text-gray-700 rounded-full text-xs">{{.}}</span>
                    {{end}}
                </span>
                {{end}}
            </div>
        </div>
        {{end}}
    </div>
    <p class="text-xs text-gray-400 mt-6 text-center">Datos de la línea de tiempo cargados exitosamente. El sondeo ha
        finalizado.</p>
    {{else}}
    <div class="p-4 bg-gray-50 rounded-lg text-center text-gray-600 mt-4">
        <p class="font-medium">Cargando línea de tiempo para Repo ID: <span
                class="font-mono text-sm text-indigo-600">{{.RepoID}}</span></p>
        <p>Análisis en curso. Próxima verificación en 10 segundos...</p>
        <svg class="animate-spin h-5 w-5 text-indigo-500 mx-auto mt-2" xmlns="http://www.w3.org/2000/svg" fill="none"
            viewBox="0 0 24 24">
            <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
            <path class="opacity-75" fill="currentColor"
                d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z">
            </path>
        </svg>
    </div>
    {{end}}
</div>